<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flipper Zero Firmware: /Users/astrr/wtf/flipperzero-firmware/furi/core/check.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flipper Zero Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_1b10a0714798903fe36325b43d76a276.html">furi</a></li><li class="navelem"><a class="el" href="dir_129cdca8bb1a0bec5ad41e77336da62e.html">core</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">check.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Furi crash and assert functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdnoreturn.h&gt;</code><br />
</div>
<p><a href="check_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa25399f3a490ed506a832f53c53fd955"><td class="memItemLeft" align="right" valign="top"><a id="aa25399f3a490ed506a832f53c53fd955" name="aa25399f3a490ed506a832f53c53fd955"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FURI_NORETURN</b>&#160;&#160;&#160;noreturn</td></tr>
<tr class="separator:aa25399f3a490ed506a832f53c53fd955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40635268a25dc32808ff0f53829a607b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check_8h.html#a40635268a25dc32808ff0f53829a607b">furi_crash</a>(message)</td></tr>
<tr class="memdesc:a40635268a25dc32808ff0f53829a607b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crash system with message.  <a href="check_8h.html#a40635268a25dc32808ff0f53829a607b">More...</a><br /></td></tr>
<tr class="separator:a40635268a25dc32808ff0f53829a607b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59cec611f7edcbd09aa8a0435a598a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check_8h.html#ad59cec611f7edcbd09aa8a0435a598a3">furi_halt</a>(message)</td></tr>
<tr class="memdesc:ad59cec611f7edcbd09aa8a0435a598a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halt system with message.  <a href="check_8h.html#ad59cec611f7edcbd09aa8a0435a598a3">More...</a><br /></td></tr>
<tr class="separator:ad59cec611f7edcbd09aa8a0435a598a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae013543a063eb030c57f477cb084731d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check_8h.html#ae013543a063eb030c57f477cb084731d">furi_check</a>(__e)</td></tr>
<tr class="memdesc:ae013543a063eb030c57f477cb084731d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check condition and crash if check failed.  <a href="check_8h.html#ae013543a063eb030c57f477cb084731d">More...</a><br /></td></tr>
<tr class="separator:ae013543a063eb030c57f477cb084731d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae72a1b2457bc7240f77d80e1fc55ec24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="check_8h.html#ae72a1b2457bc7240f77d80e1fc55ec24">furi_assert</a>(__e)</td></tr>
<tr class="memdesc:ae72a1b2457bc7240f77d80e1fc55ec24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Only in debug build: Assert condition and crash if assert failed.  <a href="check_8h.html#ae72a1b2457bc7240f77d80e1fc55ec24">More...</a><br /></td></tr>
<tr class="separator:ae72a1b2457bc7240f77d80e1fc55ec24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab5248c6f91dc8f5424e92df447772b9c"><td class="memItemLeft" align="right" valign="top"><a id="ab5248c6f91dc8f5424e92df447772b9c" name="ab5248c6f91dc8f5424e92df447772b9c"></a>
FURI_NORETURN void&#160;</td><td class="memItemRight" valign="bottom"><b>__furi_crash</b> ()</td></tr>
<tr class="memdesc:ab5248c6f91dc8f5424e92df447772b9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crash system. <br /></td></tr>
<tr class="separator:ab5248c6f91dc8f5424e92df447772b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adabb4d62445cfaeaff5219c581c81cdc"><td class="memItemLeft" align="right" valign="top"><a id="adabb4d62445cfaeaff5219c581c81cdc" name="adabb4d62445cfaeaff5219c581c81cdc"></a>
FURI_NORETURN void&#160;</td><td class="memItemRight" valign="bottom"><b>__furi_halt</b> ()</td></tr>
<tr class="memdesc:adabb4d62445cfaeaff5219c581c81cdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halt system. <br /></td></tr>
<tr class="separator:adabb4d62445cfaeaff5219c581c81cdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Furi crash and assert functions. </p>
<p >The main problem with crashing is that you can't do anything without disturbing registers, and if you disturb registers, you won't be able to see the correct register values in the debugger.</p>
<p >Current solution works around it by passing the message through r12 and doing some magic with registers in crash function. r0-r10 are stored in the ram2 on crash routine start and restored at the end. The only register that is going to be lost is r11. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae72a1b2457bc7240f77d80e1fc55ec24" name="ae72a1b2457bc7240f77d80e1fc55ec24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae72a1b2457bc7240f77d80e1fc55ec24">&#9670;&nbsp;</a></span>furi_assert</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define furi_assert</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__e</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                 \</div>
<div class="line">        ((void)(__e));   \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Only in debug build: Assert condition and crash if assert failed. </p>

</div>
</div>
<a id="ae013543a063eb030c57f477cb084731d" name="ae013543a063eb030c57f477cb084731d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae013543a063eb030c57f477cb084731d">&#9670;&nbsp;</a></span>furi_check</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define furi_check</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__e</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                                         \</div>
<div class="line">        if(!(__e)) {                             \</div>
<div class="line">            furi_crash(<span class="stringliteral">&quot;furi_check failed\r\n&quot;</span>); \</div>
<div class="line">        }                                        \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Check condition and crash if check failed. </p>

</div>
</div>
<a id="a40635268a25dc32808ff0f53829a607b" name="a40635268a25dc32808ff0f53829a607b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40635268a25dc32808ff0f53829a607b">&#9670;&nbsp;</a></span>furi_crash</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define furi_crash</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">message</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                                                      \</div>
<div class="line">        register <span class="keyword">const</span> <span class="keywordtype">void</span>* r12 <span class="keyword">asm</span>(<span class="stringliteral">&quot;r12&quot;</span>) = (<span class="keywordtype">void</span>*)message; \</div>
<div class="line">        asm <span class="keyword">volatile</span>(<span class="stringliteral">&quot;sukima%=:&quot;</span> : : <span class="stringliteral">&quot;r&quot;</span>(r12));               \</div>
<div class="line">        __furi_crash();                                       \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Crash system with message. </p>
<p >Show message after reboot. </p>

</div>
</div>
<a id="ad59cec611f7edcbd09aa8a0435a598a3" name="ad59cec611f7edcbd09aa8a0435a598a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59cec611f7edcbd09aa8a0435a598a3">&#9670;&nbsp;</a></span>furi_halt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define furi_halt</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">message</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    <span class="keywordflow">do</span> {                                                      \</div>
<div class="line">        register <span class="keyword">const</span> <span class="keywordtype">void</span>* r12 <span class="keyword">asm</span>(<span class="stringliteral">&quot;r12&quot;</span>) = (<span class="keywordtype">void</span>*)message; \</div>
<div class="line">        asm <span class="keyword">volatile</span>(<span class="stringliteral">&quot;sukima%=:&quot;</span> : : <span class="stringliteral">&quot;r&quot;</span>(r12));               \</div>
<div class="line">        __furi_halt();                                        \</div>
<div class="line">    } <span class="keywordflow">while</span>(0)</div>
</div><!-- fragment -->
<p>Halt system with message. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
