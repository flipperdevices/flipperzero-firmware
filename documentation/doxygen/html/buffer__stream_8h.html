<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flipper Zero Firmware: /Users/astrr/wtf/flipperzero-firmware/lib/toolbox/buffer_stream.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flipper Zero Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_13d21c8c6ca0e7a500ae25ea47aeacf2.html">toolbox</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">buffer_stream.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file implements the concept of a buffer stream.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;furi.h&gt;</code><br />
</div>
<p><a href="buffer__stream_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7feadaf37f40473cfc76921f8754c0f7"><td class="memItemLeft" align="right" valign="top"><a id="a7feadaf37f40473cfc76921f8754c0f7" name="a7feadaf37f40473cfc76921f8754c0f7"></a>
typedef struct <a class="el" href="struct_buffer.html">Buffer</a>&#160;</td><td class="memItemRight" valign="bottom"><b>Buffer</b></td></tr>
<tr class="separator:a7feadaf37f40473cfc76921f8754c0f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf94d38faadf61a095a8212bf100e208"><td class="memItemLeft" align="right" valign="top"><a id="acf94d38faadf61a095a8212bf100e208" name="acf94d38faadf61a095a8212bf100e208"></a>
typedef struct <a class="el" href="struct_buffer_stream.html">BufferStream</a>&#160;</td><td class="memItemRight" valign="bottom"><b>BufferStream</b></td></tr>
<tr class="separator:acf94d38faadf61a095a8212bf100e208"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0577b374a1c0c3e38578c9cb6300d919"><td class="memItemLeft" align="right" valign="top">uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a0577b374a1c0c3e38578c9cb6300d919">buffer_get_data</a> (<a class="el" href="struct_buffer.html">Buffer</a> *buffer)</td></tr>
<tr class="memdesc:a0577b374a1c0c3e38578c9cb6300d919"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get buffer data pointer.  <a href="buffer__stream_8h.html#a0577b374a1c0c3e38578c9cb6300d919">More...</a><br /></td></tr>
<tr class="separator:a0577b374a1c0c3e38578c9cb6300d919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15867e99c4ed8a581568d2f3bac2ed28"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a15867e99c4ed8a581568d2f3bac2ed28">buffer_get_size</a> (<a class="el" href="struct_buffer.html">Buffer</a> *buffer)</td></tr>
<tr class="memdesc:a15867e99c4ed8a581568d2f3bac2ed28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get buffer size.  <a href="buffer__stream_8h.html#a15867e99c4ed8a581568d2f3bac2ed28">More...</a><br /></td></tr>
<tr class="separator:a15867e99c4ed8a581568d2f3bac2ed28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372b048ce51cff4e9566868cf27af392"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a372b048ce51cff4e9566868cf27af392">buffer_reset</a> (<a class="el" href="struct_buffer.html">Buffer</a> *buffer)</td></tr>
<tr class="memdesc:a372b048ce51cff4e9566868cf27af392"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset buffer and send to free buffer pool.  <a href="buffer__stream_8h.html#a372b048ce51cff4e9566868cf27af392">More...</a><br /></td></tr>
<tr class="separator:a372b048ce51cff4e9566868cf27af392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28949d382101aa8eb7088f33cc9124b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#ab28949d382101aa8eb7088f33cc9124b">buffer_stream_alloc</a> (size_t buffer_size, size_t buffers_count)</td></tr>
<tr class="memdesc:ab28949d382101aa8eb7088f33cc9124b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new <a class="el" href="struct_buffer_stream.html">BufferStream</a> instance.  <a href="buffer__stream_8h.html#ab28949d382101aa8eb7088f33cc9124b">More...</a><br /></td></tr>
<tr class="separator:ab28949d382101aa8eb7088f33cc9124b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfaa431f0f9f5cb36596b7873dc0f57d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#acfaa431f0f9f5cb36596b7873dc0f57d">buffer_stream_free</a> (<a class="el" href="struct_buffer_stream.html">BufferStream</a> *buffer_stream)</td></tr>
<tr class="memdesc:acfaa431f0f9f5cb36596b7873dc0f57d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a <a class="el" href="struct_buffer_stream.html">BufferStream</a> instance.  <a href="buffer__stream_8h.html#acfaa431f0f9f5cb36596b7873dc0f57d">More...</a><br /></td></tr>
<tr class="separator:acfaa431f0f9f5cb36596b7873dc0f57d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2dcd2f6e0cba393d134d57a5defc95"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#acf2dcd2f6e0cba393d134d57a5defc95">buffer_stream_send_from_isr</a> (<a class="el" href="struct_buffer_stream.html">BufferStream</a> *buffer_stream, const uint8_t *data, size_t size)</td></tr>
<tr class="memdesc:acf2dcd2f6e0cba393d134d57a5defc95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write data to buffer stream, from ISR context Data will be written to the buffer until the buffer is full, and only then will the buffer be sent.  <a href="buffer__stream_8h.html#acf2dcd2f6e0cba393d134d57a5defc95">More...</a><br /></td></tr>
<tr class="separator:acf2dcd2f6e0cba393d134d57a5defc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a4427f150636ee05ca2e4a4e053cc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_buffer.html">Buffer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a05a4427f150636ee05ca2e4a4e053cc4">buffer_stream_receive</a> (<a class="el" href="struct_buffer_stream.html">BufferStream</a> *buffer_stream, TickType_t timeout)</td></tr>
<tr class="memdesc:a05a4427f150636ee05ca2e4a4e053cc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive buffer from stream.  <a href="buffer__stream_8h.html#a05a4427f150636ee05ca2e4a4e053cc4">More...</a><br /></td></tr>
<tr class="separator:a05a4427f150636ee05ca2e4a4e053cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a2dee1366c0488440c55db7d7b0687"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a00a2dee1366c0488440c55db7d7b0687">buffer_stream_get_overrun_count</a> (<a class="el" href="struct_buffer_stream.html">BufferStream</a> *buffer_stream)</td></tr>
<tr class="memdesc:a00a2dee1366c0488440c55db7d7b0687"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get stream overrun count.  <a href="buffer__stream_8h.html#a00a2dee1366c0488440c55db7d7b0687">More...</a><br /></td></tr>
<tr class="separator:a00a2dee1366c0488440c55db7d7b0687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31a81e6a6c9807ab89e964ef79ef06ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="buffer__stream_8h.html#a31a81e6a6c9807ab89e964ef79ef06ae">buffer_stream_reset</a> (<a class="el" href="struct_buffer_stream.html">BufferStream</a> *buffer_stream)</td></tr>
<tr class="memdesc:a31a81e6a6c9807ab89e964ef79ef06ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset stream and buffer pool.  <a href="buffer__stream_8h.html#a31a81e6a6c9807ab89e964ef79ef06ae">More...</a><br /></td></tr>
<tr class="separator:a31a81e6a6c9807ab89e964ef79ef06ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >This file implements the concept of a buffer stream. </p>
<p >Data is written to the buffer until the buffer is full. Then the buffer pointer is written to the stream, and the new write buffer is taken from the buffer pool. After the buffer has been read by the receiving thread, it is sent to the free buffer pool.</p>
<p >This will speed up sending large chunks of data between threads, compared to using a stream directly. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0577b374a1c0c3e38578c9cb6300d919" name="a0577b374a1c0c3e38578c9cb6300d919"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0577b374a1c0c3e38578c9cb6300d919">&#9670;&nbsp;</a></span>buffer_get_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t * buffer_get_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get buffer data pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t* </dd></dl>

</div>
</div>
<a id="a15867e99c4ed8a581568d2f3bac2ed28" name="a15867e99c4ed8a581568d2f3bac2ed28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15867e99c4ed8a581568d2f3bac2ed28">&#9670;&nbsp;</a></span>buffer_get_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t buffer_get_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get buffer size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t </dd></dl>

</div>
</div>
<a id="a372b048ce51cff4e9566868cf27af392" name="a372b048ce51cff4e9566868cf27af392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a372b048ce51cff4e9566868cf27af392">&#9670;&nbsp;</a></span>buffer_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buffer_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset buffer and send to free buffer pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab28949d382101aa8eb7088f33cc9124b" name="ab28949d382101aa8eb7088f33cc9124b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab28949d382101aa8eb7088f33cc9124b">&#9670;&nbsp;</a></span>buffer_stream_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_buffer_stream.html">BufferStream</a> * buffer_stream_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffers_count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new <a class="el" href="struct_buffer_stream.html">BufferStream</a> instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_size</td><td></td></tr>
    <tr><td class="paramname">buffers_count</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BufferStream* </dd></dl>

</div>
</div>
<a id="acfaa431f0f9f5cb36596b7873dc0f57d" name="acfaa431f0f9f5cb36596b7873dc0f57d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfaa431f0f9f5cb36596b7873dc0f57d">&#9670;&nbsp;</a></span>buffer_stream_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buffer_stream_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td>
          <td class="paramname"><em>buffer_stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a <a class="el" href="struct_buffer_stream.html">BufferStream</a> instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_stream</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a00a2dee1366c0488440c55db7d7b0687" name="a00a2dee1366c0488440c55db7d7b0687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00a2dee1366c0488440c55db7d7b0687">&#9670;&nbsp;</a></span>buffer_stream_get_overrun_count()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t buffer_stream_get_overrun_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td>
          <td class="paramname"><em>buffer_stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get stream overrun count. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_stream</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t </dd></dl>

</div>
</div>
<a id="a05a4427f150636ee05ca2e4a4e053cc4" name="a05a4427f150636ee05ca2e4a4e053cc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05a4427f150636ee05ca2e4a4e053cc4">&#9670;&nbsp;</a></span>buffer_stream_receive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_buffer.html">Buffer</a> * buffer_stream_receive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td>
          <td class="paramname"><em>buffer_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TickType_t&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive buffer from stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_stream</td><td></td></tr>
    <tr><td class="paramname">timeout</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Buffer* </dd></dl>

</div>
</div>
<a id="a31a81e6a6c9807ab89e964ef79ef06ae" name="a31a81e6a6c9807ab89e964ef79ef06ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31a81e6a6c9807ab89e964ef79ef06ae">&#9670;&nbsp;</a></span>buffer_stream_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buffer_stream_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td>
          <td class="paramname"><em>buffer_stream</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset stream and buffer pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_stream</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acf2dcd2f6e0cba393d134d57a5defc95" name="acf2dcd2f6e0cba393d134d57a5defc95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf2dcd2f6e0cba393d134d57a5defc95">&#9670;&nbsp;</a></span>buffer_stream_send_from_isr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool buffer_stream_send_from_isr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_buffer_stream.html">BufferStream</a> *&#160;</td>
          <td class="paramname"><em>buffer_stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write data to buffer stream, from ISR context Data will be written to the buffer until the buffer is full, and only then will the buffer be sent. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer_stream</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">size</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
